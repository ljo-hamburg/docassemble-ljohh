---
features:
  navigation: true
  hide navbar: false
  hide standard menu: true
  labels above fields: true
---
objects:
  mitglied: Individual
  eltern: Individual
  bedingungen: DAObject
---
include:
  - tasks.yml
---
modules:
  - .util
  - .ljo
---
code: |
  minderjaehrig = mitglied.age_in_years() < 18
  if minderjaehrig:
    need(Elternkontakt)
---
code: |
  bedingungen.akzeptiert = all([
    bedingungen.tnbedingungen,
    bedingungen.aufnahmen,
    bedingungen.finanzierung,
    bedingungen.newsletter
  ])
  if minderjaehrig:
    bedingungen.akzeptiert = (
      bedingungen.akzeptiert and bedingungen.veranstaltungsort
    )
---
code: |

  teilnahmebedingungen = DAFile('conditions')
  teilnahmebedingungen.initialize(filename="Teilnahmebedingungen.pdf")
  teilnahmebedingungen.from_url("https://ljo-hamburg.de/Teilnahmebedingungen")
  teilnahmebedingungen.commit()
---
code: |
  gesch채ftsordnung = DAFile('bylaws')
  gesch채ftsordnung.initialize(filename="Geschaeftsordnung.pdf")
  gesch채ftsordnung.from_url("https://ljo-hamburg.de/Geschaeftsordnung")
  gesch채ftsordnung.commit()
---
code: |
  status = url_args.get("status", "normal").lower()
  if status not in ["normal", "flex", "aushilfe"]:
    status = "normal"
---
code: |
  tasks = [save_data_task,
           add_member_task,
           register_member_email_task,
           register_parent_email_task,
           member_email_task,
           orga_email_task,
           archive_registration_task]
  if all(task.ready() for task in tasks):
    Abschicken = True
  else:
    Warten
---
sets: anmeldung
need: anmeldung_task
code: Warten
---
code: anmeldung_task = background_action('assemble_anmeldung', 'refresh')
---
event: assemble_anmeldung
code: background_response_action('set_anmeldung', anmeldung=anmeldeformular)
---
event: set_anmeldung
code: |
  anmeldung = action_argument('anmeldung')
  background_response()
